<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><title>Local Weather App</title><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Nunito" rel=stylesheet><style>body,html,main{height:100%;font-family:Nunito,sans-serif}.main__row{background-color:#000;height:100%}.main__col{position:relative;height:100%}.wallpaper{position:absolute;width:100%;height:100%;margin:0 -15px;background-repeat:no-repeat;background-position:center;background-size:cover}.wallpaper--back{display:none}.weather-shadow,.weather-wrapper{position:absolute;width:45%;height:100%;margin:0 -15px}.weather-shadow{opacity:.5;background-color:#000}.weather-wrapper{display:flex;flex-direction:column;color:#fff;padding:2em 1em}.weather-grow{flex-grow:1}.weather-header{display:flex;flex-wrap:wrap;flex-grow:1;width:100%}.weather-header__icon{display:flex;align-items:center;font-size:5em;margin:0 auto}.weather-header__push-right{margin:0 auto}.weather-location{font-size:2em;text-align:center;margin-top:.5em}.weather-location__details{position:relative;top:-.5em;font-size:.5em}.weather-temp{display:flex;font-size:2em;margin-top:.5em}.weather-temp__inner{margin:0 auto}.switch__button{font-size:1.8em;font-weight:700;width:1.8em;height:1.8em;border-radius:50%}.switch__button.active{background-color:#333;color:#fff}@media screen and (min-width:1024px){.weather-shadow,.weather-wrapper{width:37%}}@media screen and (min-width:768px){.weather-header__icon{font-size:6em}.weather-location{text-align:left;margin-top:0}.weather-temp{display:block;font-size:2.2em}}</style><link href=css/weather-icons.css rel=stylesheet><link href=css/weather-icons-wind.css rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--></head><body><main class="container-fluid main"><div class="main__row row"><div class="col-xs-12 main__col"><div class="wallpaper wallpaper--back"></div><div class="wallpaper wallpaper--front"></div><div class=weather-shadow></div><div class=weather-wrapper><div class=weather-grow><div class=weather-header><div class=weather-header__icon><i data-bind="attr: { class: weatherIcon }"></i></div><div class=weather-header__push-right><div class=weather-location><div data-bind="text: cityName" id=location></div><div class=weather-location__details data-bind="text: detailsPosition" id=location-details></div></div><div class=weather-temp><div class=weather-temp__inner><i class="wi wi-thermometer"></i> <span data-bind="text: temp" id=temp></span> <i data-bind="css: unit() == 'celsius' ? 'wi wi-celsius' : 'wi wi-fahrenheit'"></i></div></div></div></div></div><div class="switch text-center"><div class=btn-group aria-label=... role=group><button class="btn btn-default switch__button" data-bind="click: toggleUnit, css: { active: unit() == 'celsius' }" type=button><i class="wi wi-celsius"></i></button> <button class="btn btn-default switch__button" data-bind="click: toggleUnit, css: { active: unit() == 'fahrenheit' }" type=button><i class="wi wi-fahrenheit"></i></button></div></div></div></div></div></main><script src=https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js></script><script>var conditions=[{code:1e3,text:"Sunny",icon:["sunny","clear"]},{code:1003,text:"Partly Cloudy",icon:["cloudy","alt-cloudy"]},{code:1006,text:"Cloudy",icon:["cloudy","alt-cloudy"]},{code:1009,text:"Overcast",icon:["sunny-overcast","alt-cloudy"]},{code:1030,text:"Mist",icon:["fog","fog"]},{code:1063,text:"Patchy rain nearby",icon:["rain","alt-rain"]},{code:1066,text:"Patchy snow nearby",icon:["snow","alt-snow"]},{code:1069,text:"Patchy sleet nearby",icon:["snow","alt-snow"]},{code:1072,text:"Patchy freezing drizzle nearby",icon:["snow","alt-snow"]},{code:1087,text:"Thundery outbreaks in nearby",icon:["storm-showers","alt-showers"]},{code:1114,text:"Blowing snow",icon:["snow","alt-snow"]},{code:1117,text:"Blizzard",icon:["snow","alt-snow"]},{code:1135,text:"Fog",icon:["fog","fog"]},{code:1147,text:"Freezing fog",icon:["fog","fog"]},{code:1150,text:"Patchy light drizzle",icon:["showers","alt-showers"]},{code:1153,text:"Light drizzle",icon:["showers","alt-showers"]},{code:1168,text:"Freezing drizzle",icon:["snow","alt-snow"]},{code:1171,text:"Heavy freezing drizzle",icon:["snow","alt-snow"]},{code:1180,text:"Patchy light rain",icon:["rain","alt-rain"]},{code:1183,text:"Light rain",icon:["rain","alt-rain"]},{code:1186,text:"Moderate rain at times",icon:["rain","alt-rain"]},{code:1189,text:"Moderate rain",icon:["rain","alt-rain"]},{code:1192,text:"Heavy rain at times",icon:["rain","alt-rain"]},{code:1195,text:"Heavy rain",icon:["rain","alt-rain"]},{code:1198,text:"Light freezing rain",icon:["rain","alt-rain"]},{code:1201,text:"Moderate or heavy freezing rain",icon:["rain","alt-rain"]},{code:1204,text:"Light sleet",icon:["snow","alt-snow"]},{code:1207,text:"Moderate or heavy sleet",icon:["snow","alt-snow"]},{code:1210,text:"Patchy light snow",icon:["snow","alt-snow"]},{code:1213,text:"Light snow",icon:["snow","alt-snow"]},{code:1216,text:"Patchy moderate snow",icon:["snow","alt-snow"]},{code:1219,text:"Moderate snow",icon:["snow","alt-snow"]},{code:1222,text:"Patchy heavy snow",icon:["snow","alt-snow"]},{code:1225,text:"Heavy snow",icon:["snow","alt-snow"]},{code:1237,text:"Ice pellets",icon:["snow","alt-snow"]},{code:1240,text:"Light rain shower",icon:["showers","alt-showers"]},{code:1243,text:"Moderate or heavy rain shower",icon:["showers","alt-showers"]},{code:1246,text:"Torrential rain shower",icon:["showers","alt-showers"]},{code:1249,text:"Light sleet showers",icon:["showers","alt-showers"]},{code:1252,text:"Moderate or heavy sleet showers",icon:["showers","alt-showers"]},{code:1255,text:"Light snow showers",icon:["showers","alt-showers"]},{code:1258,text:"Moderate or heavy snow showers",icon:["snow","alt-snow"]},{code:1261,text:"Light showers of ice pellets",icon:["snow","alt-snow"]},{code:1264,text:"Moderate or heavy showers of ice pellets",icon:["snow","alt-snow"]},{code:1273,text:"Patchy light rain in area with thunder",icon:["storm-showers","alt-showers"]},{code:1276,text:"Moderate or heavy rain in area with thunder",icon:["storm-showers","alt-showers"]},{code:1279,text:"Patchy light snow in area with thunder",icon:["snow-thunderstorm","alt-snow-thunderstorm"]},{code:1282,text:"Moderate or heavy snow in area with thunder",icon:["snow-thunderstorm","alt-snow-thunderstorm"]}];$(function(){"use strict";function e(e){var o=["winter","spring","summer","fall"],t=Math.floor(3*Math.random())+1;return void 0===e&&(e=o[Math.floor(4*Math.random())]),"img/"+e+"-0"+t+(window.innerWidth<768?"m":"")+".jpg"}function o(o,t){var n="";return n=o<5&&"celsius"===t||o<41&&"fahrenheit"===t?"winter":o<15&&"celsius"===t||o<59&&"fahrenheit"===t?"fall":o<25&&"celsius"===t||o<77&&"fahrenheit"===t?"spring":"summer",e(n)}function t(){return new Promise(function(e,o){if("geolocation"in navigator){console.log("Gelocation enabled.");var t={enableHighAccuracy:!0,timeout:3e4,maximumAge:6e5};navigator.geolocation.getCurrentPosition(function(t){var r={},a=0,c=Date.now();if(s.isAvailable("sessionStorage")&&(a=window.sessionStorage.getItem("fccLocal.now")),console.log("Last API call: "+((c-a)/6e4).toPrecision(3)+" minutes"),c-a>6e5){var l=i.replace(/{key}/,n).replace(/{lat}/,t.coords.latitude).replace(/{lon}/,t.coords.longitude);$.getJSON(l,function(o){console.log("Querying API..."),r.now=Date.now(),r.lat=t.coords.latitude,r.long=t.coords.longitude,r.city=o.location.name,r.country=o.location.country,r.region=o.location.region,r.temp_c=o.current.temp_c,r.temp_f=o.current.temp_f,r.humidity=o.current.humidity,r.precip=o.current.precip_mm,r.pressure=o.current.pressure_mb,r.vis_km=o.current.vis_km,r.wind_kph=o.current.wind_kph,r.wind_dir=o.current.wind_dir,r.clouds=o.current.cloud,r.code=o.current.condition.code,r.text=o.current.condition.text,r.icon=o.current.condition.icon,r.is_day=o.current.is_day,s.isAvailable("sessionStorage")&&s.save(r),e(r)}).fail(function(){o("Apiux API isn't responding now.")})}else r=s.load(),e(r)},function(e){console.warn("error "+e.code+", "+e.message),o("Wasn't possible get the geographic possition now.")},t)}else o(Error("Geolocation is not enabled"))})}var n="91f999f0561d4d7a9b3155126171406",i="https://api.apixu.com/v1/current.json?key={key}&q={lat},{lon}",r={};ko.applyBindings(new function(){var e=this;this.weatherIcon=ko.observable("wi wi-day-cloudy-gusts"),this.cityName=ko.observable("City"),this.detailsPosition=ko.observable("Region, Country"),this.temp=ko.observable("Temp"),this.unit=ko.observable("celsius"),this.toggleUnit=function(){this.toggleBackground(),"celsius"===this.unit()?(this.unit("fahrenheit"),this.temp(r.temp_f)):(this.unit("celsius"),this.temp(r.temp_c))},this.toggleBackground=function(t){function n(n,i){for(n.css("background-image","url("+o(e.temp(),e.unit())+")");n.css("background-image")===i.css("background-image");)n.css("background-image","url("+o(e.temp(),e.unit())+")");n.fadeIn(800,function(){i.fadeOut(800),t&&t()})}var i=$(".wallpaper--back"),r=$(".wallpaper--front");"block"===r.css("display")?n(i,r):"none"===r.css("display")&&n(r,i)},t().then(function(o){console.dir(o),e.cityName(o.city),e.detailsPosition(o.region+", "+o.country),"celsius"===e.unit()?e.temp(o.temp_c):e.temp(o.temp_f);var t=conditions.find(function(e){return e.code==o.code});"1"===o.is_day?e.weatherIcon("wi wi-day-"+t.icon[0]):e.weatherIcon("wi wi-night-"+t.icon[1]),e.toggleBackground()}).catch(function(o){e.toggleBackground(function(){alert(o)})})});var s={isAvailable:function(e){var o,t="__storage_test__";try{return(o=window[e]).setItem(t,t),o.removeItem(t),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&0!==o.length}},save:function(e){console.log("Saving session storage...");var o=window.sessionStorage;for(var t in e)o.setItem("fccLocal."+t,e[t])},load:function(){console.log("Loading session storage...");var e=window.sessionStorage,o={};for(var t in e)t.startsWith("fccLocal.")&&(o[t.substring(9)]=e.getItem(t));return o}}})</script></body></html>